<div class="payment-container">
    <header class="payment-header">
        <h1 class="logo">Spotify</h1>
        <div class="progress-indicator">
            <div class="step completed">
                <span class="step-number">1</span>
                <span class="step-label">Registro</span>
            </div>
            <div class="step completed">
                <span class="step-number">2</span>
                <span class="step-label">ConfirmaciÃ³n</span>
            </div>
            <div class="step active">
                <span class="step-number">3</span>
                <span class="step-label">SuscripciÃ³n</span>
            </div>
        </div>
    </header>

    <div class="payment-card">
        <div class="welcome-section">
            <h2>Â¡Bienvenido a Gramola ESIpotify!</h2>
            <p class="welcome-message">
                EstÃ¡s a un paso de activar tu gramola virtual. Elige el plan que mejor se adapte a tu bar.
            </p>
        </div>

        <div class="subscription-plans">
            <div *ngFor="let plan of subscriptionPlans" 
                 class="plan-card"
                 [class.recommended]="plan.recommended"
                 [class.selected]="selectedPlan?.id === plan.id"
                 (click)="selectPlan(plan)">
                
                <div class="plan-header">
                    <h3 class="plan-name">{{plan.name}}</h3>
                    <div *ngIf="plan.recommended" class="recommended-badge">Recomendado</div>
                </div>

                <div class="plan-price">
                    <span class="price-amount">{{plan.price}}â‚¬</span>
                    <span class="price-period">/{{plan.period === 'monthly' ? 'mes' : 'aÃ±o'}}</span>
                </div>

                <div class="plan-savings" *ngIf="plan.savings">
                    <span class="savings-badge">Ahorras {{plan.savings}}%</span>
                </div>

                <ul class="plan-features">
                    <li *ngFor="let feature of plan.features">
                        <span class="feature-icon">âœ“</span>
                        {{feature}}
                    </li>
                </ul>

                <div class="plan-footer">
                    <button class="select-plan-btn" 
                            [class.selected]="selectedPlan?.id === plan.id">
                        {{selectedPlan?.id === plan.id ? 'âœ“ Seleccionado' : 'Seleccionar'}}
                    </button>
                </div>
            </div>
        </div>

        <!-- Resumen del pedido -->
        <div class="order-summary" *ngIf="selectedPlan">
            <h3>Resumen de tu suscripciÃ³n</h3>
            <div class="summary-details">
                <div class="summary-row">
                    <span>Plan:</span>
                    <span class="summary-value">{{selectedPlan.name}}</span>
                </div>
                <div class="summary-row">
                    <span>Precio:</span>
                    <span class="summary-value">{{selectedPlan.price}}â‚¬/{{selectedPlan.period === 'monthly' ? 'mes' : 'aÃ±o'}}</span>
                </div>
                <div class="summary-row" *ngIf="selectedPlan.savings">
                    <span>Ahorro:</span>
                    <span class="summary-value savings">{{selectedPlan.savings}}%</span>
                </div>
                <div class="summary-row total">
                    <span>Total a pagar:</span>
                    <span class="summary-value total-price">{{selectedPlan.price}}â‚¬</span>
                </div>
            </div>
        </div>

        <!-- InformaciÃ³n de pago -->
        <div class="payment-section" *ngIf="selectedPlan">
            <h3>MÃ©todo de pago</h3>
            
            <div class="payment-methods">
                <div class="payment-method" 
                     *ngFor="let method of paymentMethods"
                     [class.selected]="selectedPaymentMethod === method.id"
                     (click)="selectPaymentMethod(method.id)">
                    <span class="method-icon">{{method.icon}}</span>
                    <span class="method-name">{{method.name}}</span>
                </div>
            </div>

            <!-- Formulario de tarjeta de crÃ©dito -->
            <div class="credit-card-form" *ngIf="selectedPaymentMethod === 'card'">
                <div class="form-group">
                    <label for="cardNumber">NÃºmero de tarjeta</label>
                    <input type="text" 
                           id="cardNumber" 
                           [(ngModel)]="cardInfo.number"
                           placeholder="1234 5678 9012 3456"
                           maxlength="19"
                           class="form-control">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="expiryDate">Fecha de expiraciÃ³n</label>
                        <input type="text" 
                               id="expiryDate" 
                               [(ngModel)]="cardInfo.expiry"
                               placeholder="MM/AA"
                               maxlength="5"
                               class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="cvv">CVV</label>
                        <input type="text" 
                               id="cvv" 
                               [(ngModel)]="cardInfo.cvv"
                               placeholder="123"
                               maxlength="3"
                               class="form-control">
                    </div>
                </div>

                <div class="form-group">
                    <label for="cardholder">Nombre del titular</label>
                    <input type="text" 
                           id="cardholder" 
                           [(ngModel)]="cardInfo.holder"
                           placeholder="Como aparece en la tarjeta"
                           class="form-control">
                </div>
            </div>

            <!-- TÃ©rminos y condiciones -->
            <div class="terms-section">
                <label class="checkbox-container">
                    <input type="checkbox" [(ngModel)]="acceptedTerms">
                    <span class="checkmark"></span>
                    Acepto los <a href="#" class="terms-link">TÃ©rminos y Condiciones</a> y la <a href="#" class="terms-link">PolÃ­tica de Privacidad</a>
                </label>
            </div>

            <!-- BotÃ³n de pago -->
            <button class="payment-btn" 
                    (click)="processPayment()"
                    [disabled]="!selectedPlan || !selectedPaymentMethod || !acceptedTerms || processing">
                <span *ngIf="!processing">
                    {{selectedPlan.period === 'monthly' ? 'Suscribirme mensualmente' : 'Suscribirme anualmente'}} - {{selectedPlan.price}}â‚¬
                </span>
                <span *ngIf="processing" class="processing-text">
                    <div class="spinner"></div>
                    Procesando pago...
                </span>
            </button>

            <p class="security-notice">
                ðŸ”’ Pago seguro SSL. Tus datos estÃ¡n protegidos.
            </p>
        </div>

        <div class="support-section">
            <p>Â¿Necesitas ayuda? <a href="mailto:soporte@esipotify.com" class="support-link">Contacta con nuestro equipo</a></p>
        </div>
    </div>
</div>